using sysbus

mach create "nrf52-ci-agent"
machine LoadPlatformDescription @platforms/cpus/nrf52.repl

# 由 CI 用 sed 注入絕對 ELF 路徑
sysbus LoadELF __ELF_PATH__

# 建立一個 PTY，並把 UART0 綁上去
emulation CreateUartPtyTerminal "pty0"
connector Connect sysbus.uart0 pty0

# 讓 CI 從 log 抓到 PTY
log "UART PTY: @{sysbus.uart0.FileName}"

start
emulation RunFor "8.0"
q
